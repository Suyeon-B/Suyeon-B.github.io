---
layout: post
title: Critical Rendering Path
subtitle: ì›¹ í˜ì´ì§€ì˜ ë¹Œë“œ ê³¼ì •ì„ ìì„¸íˆ ì‚´í´ë³´ì!
tags: [Web, Javascript, DOM, CRP]
author: Suyeon Bak
comments: True
---

# 0. Intro

---

> â­ **ë Œë”ë§ ìµœì í™” ë°©ì‹ì„ ê³ ë ¤í•  ë•Œ í•„ìˆ˜ ì§€ì‹, CRP!**

- ì›¹ ë¸Œë¼ìš°ì €ê°€ ì›ë³¸ HTML ë¬¸ì„œë¥¼ ì½ì–´ë“¤ì¸ í›„, ìŠ¤íƒ€ì¼ì„ ì…íˆê³  ëŒ€í™”í˜• í˜ì´ì§€ë¡œ ë§Œë“¤ì–´ ë·°í¬íŠ¸ì— í‘œì‹œí•˜ê¸° ê¹Œì§€ì˜ ê³¼ì •
- 6ë‹¨ê³„ CRP
  ![CRP]({{ site.baseurl }}/assets/img/CRP.png){: .width-80}

1. DOM íŠ¸ë¦¬ êµ¬ì¶•
2. CSSOM íŠ¸ë¦¬ êµ¬ì¶•
3. JavaScript ì‹¤í–‰
4. ë Œë” íŠ¸ë¦¬ êµ¬ì¶•
5. ë ˆì´ì•„ì›ƒ ìƒì„±
6. í˜ì¸íŒ…

# 1. DOM íŠ¸ë¦¬ êµ¬ì¶•

---

> ğŸ’¡ **DOM ?** <br><br> - íŒŒì‹±ëœ HTML ë¬¸ì„œì˜ ê°ì²´ ê¸°ë°˜ í‘œí˜„ ë°©ì‹ <br>- ìì„¸í•œ ê°œë…ì€ â†’ [DOMì´ ë­˜ê¹Œ?]({{ site.baseurl }}/2022/09/04/DOM.html)

| ![crp_html1]({{ site.baseurl }}/assets/img/crp_html1.png){: .width-80} | ![crp_domtree1]({{ site.baseurl }}/assets/img/crp_domtree1.png){: .width-80} |
| ---------------------------------------------------------------------- | ---------------------------------------------------------------------------- |
| HTML ë¬¸ì„œ                                                              | DOM tree                                                                     |

- HTMLì˜ ì¢‹ì€ ì ì€ ë¶€ë¶„ì ìœ¼ë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤ëŠ” ì ì´ë‹¤.
- ì–´ë–¤ ì½˜í…ì¸ ê°€ í™”ë©´ì— ë‚˜íƒ€ë‚˜ê¸° ìœ„í•´ ëª¨ë“  ë¬¸ì„œê°€ loadë  í•„ìš”ê°€ ì—†ë‹¤.
- í•˜ì§€ë§Œ, CSSì™€ JavaScriptëŠ” í˜ì´ì§€ì˜ ë Œë”ë§ì„ `block`ì‹œí‚¬ ìˆ˜ ìˆë‹¤.

# 2. CSSOM íŠ¸ë¦¬ êµ¬ì¶•

---

> ğŸ¨ **CSSOM ?** <br><br> - CSS Object Model<br>- DOMê³¼ ê´€ë ¨ëœ ìŠ¤íƒ€ì¼ì˜ ê°ì²´ ê¸°ë°˜ í‘œí˜„ ë°©ì‹<br>- â€œrender blocking resourceâ€

| ![crp_css1]({{ site.baseurl }}/assets/img/crp_css1.png){: .width-80} | ![crp_cssomtree1]({{ site.baseurl }}/assets/img/crp_cssomtree1.png){: .width-80} |
| -------------------------------------------------------------------- | -------------------------------------------------------------------------------- |
| CSS íŒŒì¼                                                             | CSSOM tree                                                                       |

- ê° ë…¸ë“œì™€ ê´€ë ¨í•œ ìŠ¤íƒ€ì¼ì´ ëª…ì‹œì ìœ¼ë¡œ, or ìƒì† ë“±ì˜ ì•”ë¬µì  ë°©ì‹ìœ¼ë¡œ í‘œí˜„ë¨
- ì²˜ìŒì— CSS ë¦¬ì†ŒìŠ¤ë¥¼ ì™„ì „íˆ íŒŒì‹±í•´ì˜¤ê¸° ì „ê¹Œì§€ëŠ” ë Œë” íŠ¸ë¦¬ê°€ êµ¬ì¶•ë  ìˆ˜ ì—†ìŒ (ë¶€ë¶„ì  ì‹¤í–‰ ë¶ˆê°€ëŠ¥)
  - [ê³„ë‹¨ì‹ ìƒì†](https://developer.mozilla.org/ko/docs/Learn/CSS/Building_blocks/Cascade_and_inheritance) íŠ¹ì„± ë•Œë¬¸
  - ë¬¸ì„œ ë‚´ì—ì„œ styleì€ ê³„ì† ì˜¤ë²„ë¼ì´ë”© ë  ìˆ˜ ìˆì–´ì„œ, ì›ì¹˜ ì•ŠëŠ” CSSê°€ ì ìš©ë  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ë¬¸ì„œ ì „ì²´ë¥¼ íŒŒì‹±í•´ì˜¨ ë’¤ ë‹¤ìŒ ë‹¨ê³„ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤!
- í•˜ì§€ë§Œ, í•­ìƒ â€œrender blocking resourceâ€ì¸ ê²ƒì€ ì•„ë‹˜
  - ì˜ˆë¥¼ ë“¤ì–´ `orientation:landscape`(ê°€ë¡œ ëª¨ë“œ)ë¡œ ì„¤ì •í•´ë‘ì—ˆì§€ë§Œ ì„¸ë¡œ ëª¨ë“œë¡œ ë³´ê³  ìˆì„ ë•Œ, í•´ë‹¹ ìì›ì€ ë Œë”ë§ì„ ë§‰ì§€ ì•ŠëŠ”ë‹¤.
- JS íŒŒì¼ì€ CSSOMì´ êµ¬ì¶•ë˜ê¸°ê¹Œì§€ ëŒ€ê¸°í•´ì•¼í•˜ë¯€ë¡œ, "script blocking resource"ì´ê¸°ë„ í•¨

# 3. JavaScript ì‹¤í–‰

---

> ğŸ”ƒ **JavaScript ?** <br><br>- â€œparser blocking resourceâ€

- â€œparser blocking resourceâ€ëŠ” HTML ë¬¸ì„œ íŒŒì‹±ì´ JSì— ì˜í•´ blockëœë‹¤ëŠ” ì˜ë¯¸
  - íŒŒì„œëŠ” `<script>` íƒœê·¸ì— ë„ë‹¬í•˜ë©´ fetchë¥¼ ë©ˆì¶”ê³  ì‹¤í–‰í•œë‹¤.
  - í•´ë‹¹ ìš”ì†Œì— ì‹¤í–‰ë˜ì–´ì•¼ í•˜ë‹ˆê¹Œ!
- ë”°ë¼ì„œ ë¹„ë™ê¸°ì ìœ¼ë¡œ ì²˜ë¦¬í•´ì•¼ blockingì„ ë§‰ì„ ìˆ˜ ìˆë‹¤.

- ë·° í¬íŠ¸ì— ë¬´ì—‡ì„ ë Œë”ë§í• ì§€ ê²°ì •í•˜ê¸° ìœ„í•´ ì‚¬ìš©
- ìë°”ìŠ¤í¬ë¦½íŠ¸ í”„ë¡œê·¸ë¨ì— ì˜í•´ í˜ì´ì§€ì˜ ì½˜í…ì¸  ë° êµ¬ì¡°, ìŠ¤íƒ€ì¼ì´ ìˆ˜ì •ë˜ê¸° ìœ„í•´ ì‚¬ìš©
- HTMLê³¼ ë‹¤ë¥¸ DOMì˜ ì°¨ë³„ì 
  - í•­ìƒ ìœ íš¨í•œ HTML í˜•ì‹ì„ ê¸°ë°˜ìœ¼ë¡œ ë§Œë“¤ì–´ì§
  - ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ìˆ˜ì •ë  ìˆ˜ ìˆëŠ” ë™ì  ëª¨ë¸ì„
  - ê°€ìƒ ìš”ì†Œë¥¼ í¬í•¨í•˜ì§€ ì•ŠìŒ (Ex.Â `::after`)
  - ë³´ì´ì§€ ì•ŠëŠ” ìš”ì†Œë¥¼ í¬í•¨í•¨ (Ex.Â `display: none`)

# 4. ë Œë” íŠ¸ë¦¬ êµ¬ì¶•

---

> ğŸŒ³ **ë Œë” íŠ¸ë¦¬ ?**<br><br>: DOMê³¼ CSSOMì˜ ì¡°í•©
> [crp_rendertree]({{ site.baseurl }}/assets/img/crp_rendertree.png){: .width-80}

- í˜ì´ì§€ì— ë Œë”ë§ ë  íŠ¸ë¦¬
- â€œë³´ì´ëŠ”â€ ì»¨í…ì¸ ë§Œ ë‹´ê¸° ë•Œë¬¸ì—, `display: none` ê³¼ ê°™ì€ CSSë¥¼ ê°€ì§„ ìš”ì†ŒëŠ” í¬í•¨í•˜ì§€ ì•ŠëŠ”ë‹¤.

# 5. ë ˆì´ì•„ì›ƒ ìƒì„±

---

> ğŸªŸ **ë ˆì´ì•„ì›ƒ ?**<br><br>: ë·°í¬íŠ¸ì˜ ì‚¬ì´ì¦ˆë¥¼ ê²°ì •í•˜ëŠ” ê²ƒ
> {% highlight jsx %} <meta name="viewport" content="width=device-width,initial-scale=1">{% endhighlight %}

- `meta` ë·°í¬íŠ¸ íƒœê·¸ë¡œ ê²°ì •ë¨
  - `<head>`ì— í¬í•¨
  - `meta` íƒœê·¸ê°€ ì—†ë‹¤ë©´ defaultë¡œ `980px`
  - ë³´í†µì€ ì‚¬ìš©ìì˜ `device-width`ë¡œ ì„¤ì •

# 6. í˜ì¸íŒ…

---

> **ğŸ‘©ğŸ»â€ğŸ¨ â€˜visible contentâ€™ â†’ pixel!**

- í”½ì…€ë¡œ ë°”ë€ ì»¨í…ì¸ ë“¤ì´ í™”ë©´ì— í‘œì‹œë¨
- í˜ì¸íŒ… ì‹œê°„ì€ DOM ì‚¬ì´ì¦ˆì™€ ì ìš©ë  ìŠ¤íƒ€ì¼ì— ì˜í•´ ê²°ì •ë¨
  - ì˜ˆë¥¼ ë“¤ì–´, ë³µì¡í•œ ë°°ê²½ ì´ë¯¸ì§€ëŠ” í•œ ì»¬ëŸ¬ì˜ ë°°ê²½ë³´ë‹¤ ê¸´ ì‹œê°„ì´ í•„ìš”í•¨

# 7. ì‹¤ì œë¡œ ì–´ë–»ê²Œ ëŒì•„ê°ˆê¹Œ?

---

> **ğŸ›  Performance íƒ­ì—ì„œ í™•ì¸í•´ë³´ì!**

ì˜ˆë¥¼ ë“¤ì–´ ë‹¤ìŒê³¼ ê°™ì€ HTML íŒŒì¼ì´ë¼ë©´,

![crp_html2]({{ site.baseurl }}/assets/img/crp_html2.png){: .width-80}

Event logì— ë‹¤ìŒê³¼ ê°™ì´ CRPë¥¼ ê±°ì¹œë‹¤.

![crp_eventlog]({{ site.baseurl }}/assets/img/crp_eventlog.png){: .width-80}

1. **Send Request**
   - `index.html` GET ìš”ì²­
2. **Parse HTML**Â andÂ **Send Request**
   - HTML íŒŒì‹± ì‹œì‘, DOM êµ¬ì¶•
   - `style.css`, `main.js` GET ìš”ì²­
3. **Parse Stylesheet**
   - `style.css`ì— ë”°ë¥¸ CSSOM ìƒì„±
4. **Evaluate Script**
   - `main.js` í‰ê°€
5. **Layout**
   - HTML ë¬¸ì„œì˜ `meta` ë·°í¬íŠ¸ íƒœê·¸ì— ë”°ë¼ Layout ìƒì„±
6. **Paint**
   - pixelë“¤ í˜ì¸íŒ…

# References

---

[Understanding the Critical Rendering Path](https://bitsofco.de/understanding-the-critical-rendering-path/)

[ê³„ë‹¨ì‹ ë° ìƒì† - Web ê°œë°œ í•™ìŠµí•˜ê¸° MDN](https://developer.mozilla.org/ko/docs/Learn/CSS/Building_blocks/Cascade_and_inheritance)
